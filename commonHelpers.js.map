{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixeabay-api.js","../src/js/render-fuction.js","../src/js/functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '44853221-20be0a035158c611166c29677';\nconst apiUrl = 'https://pixabay.com/api/';\n\nexport default async function searchImage(query, page = 1, per_page = 15) {\n  const encodedQuery = encodeURIComponent(query);\n  const url = `${apiUrl}?key=${apiKey}&q=${encodedQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`;\n\n  return axios.get(url);\n}\n","import SimpleLightbox from 'simplelightbox';\n// Дополнительный импорт стилей\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Инициализация SimpleLightbox\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  nav: true,\n});\n\nexport default function createGallery(imagesData) {\n  const gallery = document.querySelector('.gallery');\n\n  // Loop through each image data and create corresponding HTML elements\n  imagesData.forEach(image => {\n    const card = document.createElement('div');\n    card.classList.add('card');\n\n    const link = document.createElement('a');\n    link.href = image.largeImageURL;\n    link.title = image.tags;\n\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n\n    link.appendChild(img);\n\n    const cardInfo = document.createElement('div');\n    cardInfo.classList.add('card-info');\n    cardInfo.innerHTML = `\n      <p>Likes ${image.likes}</p>\n      <p>Views ${image.views}</p>\n      <p>Comments ${image.comments}</p>\n      <p>Downloads ${image.downloads}</p>\n    `;\n\n    card.appendChild(link);\n    card.appendChild(cardInfo);\n\n    gallery.appendChild(card);\n  });\n\n  // Update lightbox after adding new elements\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nconst gallery = document.querySelector('.gallery');\n\nexport function errorMessage(\n  message = 'Sorry, there are no images matching your search query. Please try again!'\n) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n}\n\nexport function infoMessage() {\n  iziToast.info({\n    title: 'Внимание',\n    message: 'Введите текст для поиска изображений',\n    position: 'topRight',\n  });\n}\n\nexport function addLoader() {\n  gallery.insertAdjacentHTML(\n    'afterbegin',\n    '<div class=\"loader\">Loading...</div>'\n  );\n}\n\n// Функция для удаления загрузчика из галереи\nexport function removeLoader() {\n  const loader = gallery.querySelector('.loader');\n  if (loader) {\n    loader.parentNode.removeChild(loader);\n  }\n}\n\nexport function endCollection() {\n  iziToast.info({\n    title: 'Attention',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n  });\n}\n\nexport function scrollToNewImages() {\n  const galleryItems = document.querySelectorAll('.gallery .card');\n  if (galleryItems.length > 0) {\n    const lastItem = galleryItems[galleryItems.length - 1];\n    const itemHeight = lastItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: itemHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nexport function showErrorToast(message = 'An unexpected error occurred.') {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n}\n","import searchImage from './js/pixeabay-api';\nimport createGallery from './js/render-fuction';\n\nimport {\n  infoMessage,\n  addLoader,\n  removeLoader,\n  scrollToNewImages,\n  endCollection,\n  showErrorToast,\n  errorMessage,\n} from './js/functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchForm = document.getElementById('searchForm');\nconst input = document.querySelector('.search input');\nconst gallery = document.querySelector('.gallery');\nconst paginationContainer = document.getElementById('pagination-container');\n\nlet currentQuery = '';\nlet isSearching = false;\nlet page = 1;\nconst perPage = 15;\nlet totalHits = 0;\nlet totalPages = 0;\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n\n  if (isSearching) {\n    return;\n  }\n  if (input.value.trim() === '') {\n    infoMessage();\n    return;\n  }\n  isSearching = true;\n  page = 1;\n  currentQuery = input.value.trim();\n  gallery.innerHTML = '';\n  paginationContainer.innerHTML = ''; // Clear previous pagination\n  searchImages();\n});\n\nasync function searchImages() {\n  try {\n    addLoader();\n    const response = await searchImage(currentQuery, page, perPage);\n    totalHits = response.data.totalHits;\n    totalPages = Math.ceil(totalHits / perPage);\n    if (response.data.hits.length === 0) {\n      errorMessage();\n      input.value = ''; // Clear input field on no results\n      return;\n    } else {\n      createGallery(response.data.hits);\n      createPagination(totalPages, page);\n      if (totalHits <= page * perPage) {\n        setTimeout(() => {\n          endCollection();\n        }, 500);\n      }\n    }\n  } catch (error) {\n    console.error('Error during the search request:', error);\n    errorMessage('An error occurred during the search.');\n  } finally {\n    removeLoader();\n    isSearching = false;\n  }\n}\n\nfunction createPagination(totalPages, currentPage) {\n  paginationContainer.innerHTML = '';\n\n  const maxVisiblePages = 5;\n  let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));\n  let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);\n\n  if (endPage - startPage < maxVisiblePages - 1) {\n    startPage = Math.max(1, endPage - maxVisiblePages + 1);\n  }\n\n  if (startPage > 1) {\n    const firstPageButton = document.createElement('button');\n    firstPageButton.textContent = '1';\n    firstPageButton.classList.add('page-button');\n    if (1 === currentPage) {\n      firstPageButton.classList.add('active');\n    }\n    firstPageButton.addEventListener('click', () => goToPage(1));\n    paginationContainer.appendChild(firstPageButton);\n\n    if (startPage > 2) {\n      const dots = document.createElement('span');\n      dots.textContent = '...';\n      paginationContainer.appendChild(dots);\n    }\n  }\n\n  for (let i = startPage; i <= endPage; i++) {\n    const pageButton = document.createElement('button');\n    pageButton.textContent = i;\n    pageButton.classList.add('page-button');\n    if (i === currentPage) {\n      pageButton.classList.add('active');\n    }\n    pageButton.addEventListener('click', () => goToPage(i));\n    paginationContainer.appendChild(pageButton);\n  }\n\n  if (endPage < totalPages) {\n    if (endPage < totalPages - 1) {\n      const dots = document.createElement('span');\n      dots.textContent = '...';\n      paginationContainer.appendChild(dots);\n    }\n\n    const lastPageButton = document.createElement('button');\n    lastPageButton.textContent = totalPages;\n    lastPageButton.classList.add('page-button');\n    if (totalPages === currentPage) {\n      lastPageButton.classList.add('active');\n    }\n    lastPageButton.addEventListener('click', () => goToPage(totalPages));\n    paginationContainer.appendChild(lastPageButton);\n  }\n}\n\nfunction goToPage(pageNumber) {\n  if (isSearching || pageNumber === page) {\n    return;\n  }\n  page = pageNumber;\n  gallery.innerHTML = '';\n  searchImages();\n}\n\ndocument.addEventListener('touchstart', function () {}, { passive: true });\ndocument.addEventListener('touchmove', function () {}, { passive: true });\n"],"names":["apiKey","apiUrl","searchImage","query","page","per_page","encodedQuery","url","axios","lightbox","SimpleLightbox","createGallery","imagesData","gallery","image","card","link","img","cardInfo","errorMessage","message","iziToast","infoMessage","addLoader","removeLoader","loader","endCollection","searchForm","input","paginationContainer","currentQuery","isSearching","perPage","totalHits","totalPages","event","searchImages","response","createPagination","error","currentPage","maxVisiblePages","startPage","endPage","firstPageButton","goToPage","dots","i","pageButton","lastPageButton","pageNumber"],"mappings":"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"}